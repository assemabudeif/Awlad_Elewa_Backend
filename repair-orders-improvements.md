# ๐ง ุชุญุณููุงุช ูุธุงู ุทูุจุงุช ุงูุฅุตูุงุญ (Repair Orders System)

## ๐ **ููุฎุต ุงูุชุญุณููุงุช ุงูููุฌุฒุฉ**

ุชู ูุฑุงุฌุนุฉ ูุชุญุณูู ูุธุงู ุทูุจุงุช ุงูุฅุตูุงุญ ุจุงููุงูู ูุถูุงู ุงูุฃุฏุงุก ุงูุฃูุซู ูุงููุธุงุฆู ุงููุชูุฏูุฉ.

---

## ๐ **ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง**

### 1. **ูุดููุฉ ุงูุชุนุงูู ูุน ุงููููุงุช ูู API**
```php
// ูุจู ุงูุฅุตูุงุญ (ุฎุทุฃ ูุญุชูู)
$data['photo'] = $request->photo->store('repairs', 'public') ?? null;
$data['audio'] = $request->audio->store('repairs', 'public') ?? null;

// ุจุนุฏ ุงูุฅุตูุงุญ (ุขูู)
if ($request->hasFile('photo')) {
    $data['photo'] = $request->file('photo')->store('repairs', 'public');
}

if ($request->hasFile('audio')) {
    $data['audio'] = $request->file('audio')->store('repairs', 'public');
}
```

### 2. **ุชูุฑุงุฑ ูู ุฃููุงุน ุงููููุงุช ุงูุตูุชูุฉ ุงููุณููุญุฉ**
```php
// ูุจู ุงูุฅุตูุงุญ (ุชูุฑุงุฑ ูู ุงูููู)
'audio' => 'nullable|file|mimes:mp3,wav,ogg,m4a,aac,flac,wma,m4b,m4p,m4r,m4v,m4b,m4p,m4r,m4v'

// ุจุนุฏ ุงูุฅุตูุงุญ (ูุธูู ููุญุฏูุฏ ุงูุญุฌู)
'audio' => 'nullable|file|mimes:mp3,wav,ogg,m4a,aac,flac,wma,m4b,m4p,m4r|max:10240'
```

### 3. **ุนุฏู ุฅุฑุฌุงุน URLs ูุงููุฉ ูููููุงุช ูู API**
```php
// ูุจู ุงูุฅุตูุงุญ
'photo' => $this->photo,
'audio' => $this->audio,

// ุจุนุฏ ุงูุฅุตูุงุญ
'photo' => $this->photo_url,
'audio' => $this->audio_url,
```

---

## โจ **ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ**

### 1. **ูุธุงู ุงูุชูููุฉ ุงููุชุทูุฑ**
```php
// ุญููู ุฌุฏูุฏุฉ ูู ุงููููุฐุฌ
protected $fillable = [
    'user_id', 'description', 'photo', 'audio', 
    'phone1', 'phone2', 'status',
    'estimated_cost',    // ุงูุชูููุฉ ุงูููุฏุฑุฉ
    'final_cost',        // ุงูุชูููุฉ ุงูููุงุฆูุฉ  
    'notes'              // ููุงุญุธุงุช ุฅุถุงููุฉ
];

protected $casts = [
    'estimated_cost' => 'decimal:2',
    'final_cost' => 'decimal:2',
];
```

### 2. **ุฏูุงู ูุณุงุนุฏุฉ ูุชูุฏูุฉ ูู ุงููููุฐุฌ**
```php
// ุงูุชุญูู ูู ุงูุญุงูุฉ
public function canBeEdited()           // ุฅููุงููุฉ ุงูุชุนุฏูู
public function canBeCancelled()       // ุฅููุงููุฉ ุงูุฅูุบุงุก

// ูุนูููุงุช ุงูุญุงูุฉ
public function getStatusTextAttribute()  // ุงููุต ุจุงูุนุฑุจูุฉ
public function getStatusColorAttribute() // ููู ุงูุญุงูุฉ

// ูุญุต ุงููููุงุช
public function hasPhoto()             // ูุฌูุฏ ุงูุตูุฑุฉ
public function hasAudio()             // ูุฌูุฏ ุงูุตูุช

// ุฑูุงุจุท ุงููููุงุช
public function getPhotoUrlAttribute() // ุฑุงุจุท ุงูุตูุฑุฉ
public function getAudioUrlAttribute() // ุฑุงุจุท ุงูุตูุช
```

### 3. **ุฅุดุนุงุฑุงุช ุชุบููุฑ ุงูุญุงูุฉ**
```php
// ุฅุดุนุงุฑ ุชููุงุฆู ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุทูุจ ุงูุฅุตูุงุญ
public function sendRepairOrderStatusChangedNotification(RepairOrder $repairOrder, $oldStatus, $newStatus)
{
    $statusMessages = [
        'pending' => 'ุทูุจ ุงูุตูุงูุฉ ููุฏ ุงูุงูุชุธุงุฑ',
        'in_progress' => 'ุทูุจ ุงูุตูุงูุฉ ููุฏ ุงูุชูููุฐ',
        'completed' => 'ุชู ุฅููุงู ุตูุงูุฉ ุฌูุงุฒู',
        'cancelled' => 'ุชู ุฅูุบุงุก ุทูุจ ุงูุตูุงูุฉ'
    ];
    
    // ุฅุฑุณุงู FCM + ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
}
```

---

## ๐จ **ุชุญุณููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู**

### 1. **ุตูุญุฉ ุงูุชูุงุตูู ุงููุญุณูุฉ**
- โ ุนุฑุถ ุงูุชูููุฉ ุงูููุฏุฑุฉ ูุงูููุงุฆูุฉ
- โ ุนุฑุถ ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ  
- โ ุฃุฒุฑุงุฑ ูุนุฑุถ ุงูุตูุฑุฉ ุจุงูุญุฌู ุงููุงูู
- โ ุฅููุงููุฉ ุชุญููู ุงูููู ุงูุตูุชู
- โ ุฏุนู ูุชุนุฏุฏ ูุฃููุงุน ุงููููุงุช ุงูุตูุชูุฉ

### 2. **ุตูุญุฉ ุงูุชุนุฏูู ุงููุทูุฑุฉ**
```html
<!-- ุญููู ุฌุฏูุฏุฉ -->
<input type="number" name="estimated_cost" placeholder="ุงูุชูููุฉ ุงูููุฏุฑุฉ">
<input type="number" name="final_cost" placeholder="ุงูุชูููุฉ ุงูููุงุฆูุฉ">
<textarea name="notes" placeholder="ููุงุญุธุงุช ุฅุถุงููุฉ" maxlength="1000"></textarea>
```

### 3. **ุนุฑุถ ูุญุณู ูููููุงุช**
```html
<!-- ุงูุตูุฑุฉ ูุน ุฑุงุจุท ููุนุฑุถ ุงููุงูู -->
@if($repairOrder->hasPhoto())
    <img src="{{ $repairOrder->photo_url }}">
    <a href="{{ $repairOrder->photo_url }}" target="_blank">ุนุฑุถ ุจุงูุญุฌู ุงููุงูู</a>
@endif

<!-- ุงูุตูุช ูุน ุฏุนู ุฃููุงุน ูุชุนุฏุฏุฉ ูุชุญููู -->
@if($repairOrder->hasAudio())
    <audio controls>
        <source src="{{ $repairOrder->audio_url }}" type="audio/mpeg">
        <source src="{{ $repairOrder->audio_url }}" type="audio/wav">
        <source src="{{ $repairOrder->audio_url }}" type="audio/ogg">
    </audio>
    <a href="{{ $repairOrder->audio_url }}" download>ุชุญููู ุงูููู ุงูุตูุชู</a>
@endif
```

---

## ๐ก **ุชุญุณููุงุช API**

### 1. **Resource ูุญุณู ูุน ูุนูููุงุช ุฅุถุงููุฉ**
```php
// RepairOrderResource ุงููุญุฏุซ
return [
    'id' => $this->id,
    'user' => $this->user,
    'description' => $this->description,
    'photo' => $this->photo_url,              // ุฑุงุจุท ูุงูู
    'audio' => $this->audio_url,              // ุฑุงุจุท ูุงูู
    'phone1' => $this->phone1,
    'phone2' => $this->phone2,
    'status' => $this->status,
    'status_text' => $this->status_text,      // ุงููุต ุงูุนุฑุจู
    'status_color' => $this->status_color,    // ููู ุงูุญุงูุฉ
    'estimated_cost' => $this->estimated_cost,
    'final_cost' => $this->final_cost,
    'notes' => $this->notes,
    'can_be_edited' => $this->canBeEdited(),
    'can_be_cancelled' => $this->canBeCancelled(),
    'has_photo' => $this->hasPhoto(),
    'has_audio' => $this->hasAudio(),
    'created_at' => $this->created_at,
    'updated_at' => $this->updated_at,
];
```

### 2. **Validation ูุญุณู**
```php
return [
    'description' => 'required|string',
    'photo' => 'nullable|image|mimes:jpeg,png,jpg,gif,svg|max:2048',
    'audio' => 'nullable|file|mimes:mp3,wav,ogg,m4a,aac,flac,wma,m4b,m4p,m4r|max:10240',
    'phone1' => 'required|string',
    'phone2' => 'nullable|string',
    'estimated_cost' => 'nullable|numeric|min:0|max:999999.99',
    'final_cost' => 'nullable|numeric|min:0|max:999999.99',
    'notes' => 'nullable|string|max:1000',
];
```

---

## ๐๏ธ **ุชุญุฏูุซุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช**

### 1. **ุญููู ุฌุฏูุฏุฉ ูู ุฌุฏูู repair_orders**
```sql
ALTER TABLE repair_orders ADD COLUMN estimated_cost DECIMAL(10,2) NULL COMMENT 'ุงูุชูููุฉ ุงูููุฏุฑุฉ ููุฅุตูุงุญ';
ALTER TABLE repair_orders ADD COLUMN final_cost DECIMAL(10,2) NULL COMMENT 'ุงูุชูููุฉ ุงูููุงุฆูุฉ ููุฅุตูุงุญ';
ALTER TABLE repair_orders ADD COLUMN notes TEXT NULL COMMENT 'ููุงุญุธุงุช ุฅุถุงููุฉ ุนูู ุงูุทูุจ';
```

### 2. **Migration ููุธู**
```php
// 2025_06_30_201424_add_cost_fields_to_repair_orders_table.php
Schema::table('repair_orders', function (Blueprint $table) {
    $table->decimal('estimated_cost', 10, 2)->nullable()->after('status');
    $table->decimal('final_cost', 10, 2)->nullable()->after('estimated_cost');
    $table->text('notes')->nullable()->after('final_cost');
});
```

---

## ๐๏ธ **ุฃุฏูุงุช ุฅุฏุงุฑูุฉ ุฌุฏูุฏุฉ**

### 1. **ุฃูุฑ ุชูุธูู ุงููููุงุช**
```bash
# ูุญุต ุงููููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ (ุจุฏูู ุญุฐู)
php artisan repairs:cleanup-files --dry-run

# ุชูุธูู ุงููููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ
php artisan repairs:cleanup-files
```

**ูููุฒุงุช ุงูุฃูุฑ:**
- โ ูุญุต ุขูู ูููููุงุช ุงููุนุฒููุฉ
- โ ุญุณุงุจ ุญุฌู ุงูุชุฎุฒูู ุงูููููุฑ
- โ ูุนุงููุฉ ูุจู ุงูุญุฐู ูุน `--dry-run`
- โ ุชูุงุฑูุฑ ููุตูุฉ ููุนูููุงุช

---

## ๐ **ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุญุณู**

### 1. **ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ**
- โ **ุฅูุดุงุก ุทูุจ ุฅุตูุงุญ** - ุฅุดุนุงุฑ ููุฑู ููุนููู
- โ **ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ** - ุชุญุฏูุซุงุช ูู ุงูููุช ุงููุนูู
- โ **ุฅููุงู ุงูุฅุตูุงุญ** - ุฅุดุนุงุฑ ุงูุงูุชูุงุก
- โ **ุฅูุบุงุก ุงูุทูุจ** - ุชูุจูู ุงูุฅูุบุงุก

### 2. **ุงูุจูุงูุงุช ุงููุฑุณูุฉ ูุน ุงูุฅุดุนุงุฑ**
```json
{
    "repair_order_id": 123,
    "type": "repair_order_status_changed",
    "old_status": "pending",
    "new_status": "in_progress"
}
```

---

## ๐ **ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก**

### **ูุจู ุงูุชุญุณููุงุช:**
- โ ุฃุฎุทุงุก ูู ุฑูุน ุงููููุงุช
- โ ุนุฏู ูุฌูุฏ ุชูููุฉ ููุฏุฑุฉ
- โ ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ุชุบููุฑ ุงูุญุงูุฉ
- โ ุนุฑุถ ุจุณูุท ูููููุงุช
- โ ูุง ุชูุฌุฏ ุฃุฏูุงุช ุชูุธูู

### **ุจุนุฏ ุงูุชุญุณููุงุช:**
- โ ุฑูุน ุขูู ูููููุงุช ูุน ุงูุชุญูู
- โ ูุธุงู ุชูููุฉ ูุชูุงูู (ููุฏุฑุฉ + ููุงุฆูุฉ)
- โ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ ูุฌููุน ุงูุชุบููุฑุงุช
- โ ุนุฑุถ ูุญุณู ูุน ุชุญููู ูุนุฑุถ ูุงูู
- โ ุฃุฏูุงุช ุชูุธูู ูุตูุงูุฉ ุชููุงุฆูุฉ

---

## ๐ฏ **ุงูููุฒุงุช ุงูููุงุฆูุฉ**

### **ููุนููุงุก (API):**
1. **ุฑูุน ุขูู** ููุตูุฑ ูุงููููุงุช ุงูุตูุชูุฉ
2. **ุฅุดุนุงุฑุงุช ููุฑูุฉ** ูุชุญุฏูุซุงุช ุงูุทูุจ
3. **ูุนูููุงุช ุดุงููุฉ** ุนู ุญุงูุฉ ุงูุทูุจ
4. **ุฑูุงุจุท ูุจุงุดุฑุฉ** ูููููุงุช ุงููุฑููุนุฉ

### **ููุฅุฏุงุฑุฉ (Admin Panel):**
1. **ุฅุฏุงุฑุฉ ุงูุชูููุฉ** (ููุฏุฑุฉ ูููุงุฆูุฉ)
2. **ููุงุญุธุงุช ููุตูุฉ** ุนูู ูู ุทูุจ
3. **ุนุฑุถ ูุญุณู** ูููููุงุช ูุน ุชุญููู
4. **ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ** ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ
5. **ุฃุฏูุงุช ุชูุธูู** ูููููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ

### **ูููุธุงู:**
1. **ูุนุงูุฌุฉ ุขููุฉ** ูููููุงุช
2. **ุชุฎุฒูู ูุญุณู** ููุจูุงูุงุช
3. **ุฃุฏูุงุช ุตูุงูุฉ** ุชููุงุฆูุฉ
4. **ูุนุงูุฌุฉ ุฃุฎุทุงุก** ุดุงููุฉ

---

## ๐ **ุงููุชูุฌุฉ ุงูููุงุฆูุฉ**

ุชู ุชุทููุฑ ูุธุงู ุทูุจุงุช ุงูุฅุตูุงุญ ูู **ูุธุงู ุจุณูุท** ุฅูู **ููุตุฉ ูุชูุงููุฉ** ุชุดูู:

- ๐ง **ุฅุฏุงุฑุฉ ุดุงููุฉ** ููุทูุจุงุช ูุน ุงูุชูููุฉ ูุงูููุงุญุธุงุช
- ๐ **ุฅุดุนุงุฑุงุช ุฐููุฉ** ูุฌููุน ูุฑุงุญู ุงูุทูุจ  
- ๐ฑ **API ูุชุทูุฑ** ูุน ูุนูููุงุช ููุตูุฉ
- ๐จ **ูุงุฌูุฉ ูุญุณูุฉ** ูุนุฑุถ ุงููููุงุช
- ๐๏ธ **ุฃุฏูุงุช ุตูุงูุฉ** ุชููุงุฆูุฉ ูููุธุงู

**ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ุจููุงุกุฉ ุนุงููุฉ ูููุซูููุฉ ูุทููุฉ!** โ 